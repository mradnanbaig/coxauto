<div class="finance-calculator">
  <h3>Finance Calculator</h3>
  
  <div class="calculator-inputs">
    <div class="input-group">
      <label for="deposit">Deposit Amount:</label>
      <div class="input-with-info">
        <input
          id="deposit"
          type="number"
          [(ngModel)]="financeInput.deposit"
          (ngModelChange)="onInputChange()"
          [min]="0"
          [max]="vehicle.price"
          class="currency-input"
        />
        <span class="percentage-info">{{ getDepositPercentage() }}% of vehicle price</span>
      </div>
    </div>

    <div class="input-group">
      <label for="term">Loan Term (months):</label>
      <select
        id="term"
        [(ngModel)]="financeInput.term"
        (ngModelChange)="onInputChange()"
        class="term-select"
      >
        <option *ngFor="let term of termOptions" [value]="term">
          {{ term }} months ({{ (term / 12) | number:'1.0-1' }} years)
        </option>
      </select>
    </div>
  </div>

  <div *ngIf="loading" class="loading">
    Calculating finance quote...
  </div>

  <div *ngIf="error" class="error">
    <p>{{ error }}</p>
    <button (click)="calculateFinance()" class="retry-btn">Retry</button>
  </div>

  <div *ngIf="financeQuote && !loading && !error" class="finance-results">
    <h4>Finance Quote</h4>
    
    <div class="results-grid">
      <div class="result-item">
        <span class="label">On-the-road Price:</span>
        <span class="value">{{ formatCurrency(financeQuote.onTheRoadPrice) }}</span>
      </div>
      
      <div class="result-item">
        <span class="label">Total Deposit:</span>
        <span class="value">{{ formatCurrency(financeQuote.totalDeposit) }}</span>
      </div>
      
      <div class="result-item">
        <span class="label">Total Amount of Credit:</span>
        <span class="value">{{ formatCurrency(financeQuote.totalAmountOfCredit) }}</span>
      </div>
      
      <div class="result-item">
        <span class="label">Number of Monthly Payments:</span>
        <span class="value">{{ financeQuote.numberOfMonthlyPayments }}</span>
      </div>
      
      <div class="result-item highlight">
        <span class="label">Monthly Payment:</span>
        <span class="value">{{ formatCurrency(financeQuote.monthlyPayment) }}</span>
      </div>
    </div>

    <div class="total-cost">
      <strong>
        Total to Pay: {{ formatCurrency(financeQuote.totalDeposit + (financeQuote.monthlyPayment * financeQuote.numberOfMonthlyPayments)) }}
      </strong>
    </div>
  </div>
</div>